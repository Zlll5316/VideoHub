# 🔍 诊断数据库问题

## 请告诉我具体的情况

### 问题 1：SQL 脚本执行了吗？
- [ ] 是，已经执行了 SQL 脚本
- [ ] 否，还没有执行

### 问题 2：如果执行了，结果是什么？
- [ ] 成功执行，没有错误
- [ ] 有错误信息（请告诉我具体的错误）

### 问题 3：在 Supabase Table Editor 中能看到表吗？
1. 打开 Supabase Dashboard
2. 点击左侧菜单的 "Table Editor"
3. 看看能否看到以下表：
   - `teams`
   - `team_members`
   - `team_folders`
   - `team_videos`

## 🔧 快速检查步骤

### 步骤 1：检查表是否存在
在 Supabase SQL Editor 中执行以下查询：

```sql
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name IN ('teams', 'team_members', 'team_folders', 'team_videos');
```

**如果返回 4 行**：表已创建，问题可能在 RLS 策略
**如果返回 0 行或少于 4 行**：表没有创建成功

### 步骤 2：检查 RLS 是否启用
```sql
SELECT tablename, rowsecurity 
FROM pg_tables 
WHERE schemaname = 'public' 
AND tablename IN ('teams', 'team_members', 'team_folders', 'team_videos');
```

### 步骤 3：检查当前用户
在应用的控制台（F12）中，检查：
1. 是否已登录？
2. 用户 ID 是什么？

## 🚨 常见问题

### 问题 A：表已创建但还是报错
**可能原因**：RLS 策略阻止了访问

**解决方案**：临时禁用 RLS 测试（仅用于调试）

```sql
-- 临时禁用 RLS（仅用于测试）
ALTER TABLE public.teams DISABLE ROW LEVEL SECURITY;
ALTER TABLE public.team_members DISABLE ROW LEVEL SECURITY;
ALTER TABLE public.team_folders DISABLE ROW LEVEL SECURITY;
ALTER TABLE public.team_videos DISABLE ROW LEVEL SECURITY;
```

⚠️ **注意**：这只是临时测试，确认问题后要重新启用 RLS。

### 问题 B：videos 表不存在
如果 `team_videos` 表创建失败，可能是因为 `videos` 表不存在。

**解决方案**：先创建 `videos` 表，或者修改 `team_videos` 的外键约束。

### 问题 C：权限问题
**可能原因**：当前用户没有创建表的权限

**解决方案**：确保你使用的是项目所有者账号，或者联系项目管理员。

## 📋 请提供以下信息

1. **SQL 执行结果**：是否有错误？具体错误信息是什么？
2. **表是否存在**：在 Table Editor 中能看到表吗？
3. **浏览器控制台错误**：按 F12，查看 Console 标签，有什么错误？
4. **Network 请求**：按 F12，查看 Network 标签，找到失败的请求，看看响应是什么？

把这些信息告诉我，我会帮你精确解决问题！
