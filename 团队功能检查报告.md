# å›¢é˜ŸåŠŸèƒ½æ£€æŸ¥æŠ¥å‘Š

## âœ… å·²å®ç°çš„åŠŸèƒ½

### 1. é‚€è¯·æˆå‘˜åŠŸèƒ½
- âœ… **å¯ä»¥é‚€è¯·æˆå‘˜**ï¼šé€šè¿‡é‚®ç®±é‚€è¯·ï¼Œæ”¯æŒè®¾ç½®è§’è‰²ï¼ˆAdmin/Editor/Viewerï¼‰
- âœ… **é˜²é‡å¤é‚€è¯·**ï¼šæ£€æŸ¥é‚®ç®±æ˜¯å¦å·²ç»æ˜¯å›¢é˜Ÿæˆå‘˜
- âœ… **é‚€è¯·è®°å½•**ï¼šåˆ›å»º `team_members` è®°å½•ï¼ŒçŠ¶æ€ä¸º 'Pending'

### 2. æˆå‘˜ç®¡ç†
- âœ… **æŸ¥çœ‹æˆå‘˜åˆ—è¡¨**ï¼šæ˜¾ç¤ºæ‰€æœ‰å›¢é˜Ÿæˆå‘˜åŠå…¶è§’è‰²ã€çŠ¶æ€
- âœ… **åˆ é™¤æˆå‘˜**ï¼šç®¡ç†å‘˜å¯ä»¥åˆ é™¤æˆå‘˜ï¼ˆæœ‰æƒé™æ£€æŸ¥ï¼‰

### 3. æ–‡ä»¶å¤¹ç®¡ç†
- âœ… **åˆ›å»ºæ–‡ä»¶å¤¹**ï¼šå¯ä»¥åˆ›å»ºå›¢é˜Ÿæ–‡ä»¶å¤¹
- âœ… **æŸ¥çœ‹æ–‡ä»¶å¤¹åˆ—è¡¨**ï¼šæ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶å¤¹åŠå…¶è§†é¢‘æ•°é‡
- âœ… **åˆ é™¤æ–‡ä»¶å¤¹**ï¼šæœ‰æƒé™æ£€æŸ¥ï¼ˆOwner/Admin/Editorï¼‰

## âŒ å‘ç°çš„é—®é¢˜

### é—®é¢˜ 1ï¼šé‚€è¯·æˆå‘˜æ— æ³•è‡ªåŠ¨æ¿€æ´»
**æè¿°**ï¼š
- é‚€è¯·çš„æˆå‘˜çŠ¶æ€æ˜¯ 'Pending'
- å½“è¢«é‚€è¯·çš„ç”¨æˆ·ç™»å½•æ—¶ï¼Œæ²¡æœ‰è‡ªåŠ¨æ¿€æ´»æœºåˆ¶
- è¢«é‚€è¯·çš„ç”¨æˆ·å³ä½¿ç™»å½•äº†ï¼ŒçŠ¶æ€ä»ç„¶æ˜¯ 'Pending'ï¼Œæ— æ³•æ­£å¸¸ä½¿ç”¨åŠŸèƒ½

**å½±å“**ï¼š
- è¢«é‚€è¯·çš„ç”¨æˆ·æ— æ³•åˆ›å»ºæ–‡ä»¶å¤¹
- è¢«é‚€è¯·çš„ç”¨æˆ·æ— æ³•åˆ†äº«è§†é¢‘
- è¢«é‚€è¯·çš„ç”¨æˆ·æ— æ³•æ­£å¸¸ä½¿ç”¨å›¢é˜ŸåŠŸèƒ½

**è§£å†³æ–¹æ¡ˆ**ï¼š
éœ€è¦åœ¨ `TeamSpace.tsx` çš„ `loadTeamData` å‡½æ•°ä¸­æ·»åŠ è‡ªåŠ¨æ¿€æ´»é€»è¾‘ï¼š
- æ£€æŸ¥å½“å‰ç™»å½•ç”¨æˆ·çš„é‚®ç®±æ˜¯å¦åŒ¹é… 'Pending' çŠ¶æ€çš„é‚€è¯·
- å¦‚æœåŒ¹é…ï¼Œè‡ªåŠ¨æ›´æ–°çŠ¶æ€ä¸º 'Active'ï¼Œå¹¶è®¾ç½® `user_id`

### é—®é¢˜ 2ï¼šåˆ›å»ºæ–‡ä»¶å¤¹ç¼ºå°‘æƒé™æ£€æŸ¥
**æè¿°**ï¼š
- `handleCreateFolder` å‡½æ•°åªæ£€æŸ¥äº† `team` å’Œ `currentUser` æ˜¯å¦å­˜åœ¨
- æ²¡æœ‰æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯å›¢é˜Ÿæˆå‘˜
- æ²¡æœ‰æ£€æŸ¥ç”¨æˆ·çŠ¶æ€æ˜¯å¦ä¸º 'Active'

**å½±å“**ï¼š
- ä»»ä½•ç™»å½•ç”¨æˆ·éƒ½å¯ä»¥åˆ›å»ºæ–‡ä»¶å¤¹ï¼ˆåªè¦çŸ¥é“ team_idï¼‰
- ä¸ç¬¦åˆæƒé™æ§åˆ¶è¦æ±‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
åœ¨ `handleCreateFolder` ä¸­æ·»åŠ æƒé™æ£€æŸ¥ï¼š
- æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯å›¢é˜Ÿæˆå‘˜
- æ£€æŸ¥ç”¨æˆ·çŠ¶æ€æ˜¯å¦ä¸º 'Active'
- æ‰€æœ‰è§’è‰²ï¼ˆOwner/Admin/Editor/Viewerï¼‰éƒ½å¯ä»¥åˆ›å»ºæ–‡ä»¶å¤¹

### é—®é¢˜ 3ï¼šåˆ†äº«è§†é¢‘ç¼ºå°‘æƒé™æ£€æŸ¥
**æè¿°**ï¼š
- `handleShareToTeam` å‡½æ•°ï¼ˆåœ¨ `VideoDetail.tsx` ä¸­ï¼‰åªæ£€æŸ¥äº†ç”¨æˆ·æ˜¯å¦ç™»å½•
- æ²¡æœ‰æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯å›¢é˜Ÿæˆå‘˜
- æ²¡æœ‰æ£€æŸ¥ç”¨æˆ·çŠ¶æ€æ˜¯å¦ä¸º 'Active'

**å½±å“**ï¼š
- ä»»ä½•ç™»å½•ç”¨æˆ·éƒ½å¯ä»¥åˆ†äº«è§†é¢‘åˆ°å›¢é˜Ÿæ–‡ä»¶å¤¹
- ä¸ç¬¦åˆæƒé™æ§åˆ¶è¦æ±‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
åœ¨ `handleShareToTeam` ä¸­æ·»åŠ æƒé™æ£€æŸ¥ï¼š
- æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯å›¢é˜Ÿæˆå‘˜
- æ£€æŸ¥ç”¨æˆ·çŠ¶æ€æ˜¯å¦ä¸º 'Active'
- æ‰€æœ‰è§’è‰²éƒ½å¯ä»¥åˆ†äº«è§†é¢‘

## ğŸ“‹ ä¿®å¤å»ºè®®

### ä¼˜å…ˆçº§ 1ï¼šæ·»åŠ è‡ªåŠ¨æ¿€æ´»æœºåˆ¶
åœ¨ `TeamSpace.tsx` çš„ `loadTeamData` å‡½æ•°ä¸­ï¼ŒåŠ è½½æˆå‘˜åˆ—è¡¨åï¼Œæ·»åŠ è‡ªåŠ¨æ¿€æ´»é€»è¾‘ï¼š

```typescript
// æ£€æŸ¥æ˜¯å¦æœ‰å¾…æ¿€æ´»çš„é‚€è¯·ï¼ˆé‚®ç®±åŒ¹é…ï¼‰
const { data: pendingInvite } = await supabase
  .from('team_members')
  .select('*')
  .eq('team_id', teamInfo.id)
  .eq('email', currentUser.email)
  .eq('status', 'Pending')
  .maybeSingle();

if (pendingInvite) {
  // è‡ªåŠ¨æ¿€æ´»é‚€è¯·
  await supabase
    .from('team_members')
    .update({
      user_id: currentUser.id,
      status: 'Active'
    })
    .eq('id', pendingInvite.id);
}
```

### ä¼˜å…ˆçº§ 2ï¼šæ·»åŠ åˆ›å»ºæ–‡ä»¶å¤¹æƒé™æ£€æŸ¥
åœ¨ `handleCreateFolder` å‡½æ•°ä¸­æ·»åŠ ï¼š

```typescript
// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯å›¢é˜Ÿæˆå‘˜
const currentMember = members.find(m => m.user_id === currentUser.id);
if (!currentMember || currentMember.status !== 'Active') {
  alert('æ‚¨ä¸æ˜¯å›¢é˜Ÿæˆå‘˜æˆ–é‚€è¯·å°šæœªæ¿€æ´»');
  return;
}
```

### ä¼˜å…ˆçº§ 3ï¼šæ·»åŠ åˆ†äº«è§†é¢‘æƒé™æ£€æŸ¥
åœ¨ `VideoDetail.tsx` çš„ `handleShareToTeam` å‡½æ•°ä¸­æ·»åŠ ï¼š

```typescript
// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯å›¢é˜Ÿæˆå‘˜
const { data: member } = await supabase
  .from('team_members')
  .select('*')
  .eq('team_id', team.team_id)
  .eq('user_id', user.id)
  .eq('status', 'Active')
  .maybeSingle();

if (!member) {
  alert('æ‚¨ä¸æ˜¯å›¢é˜Ÿæˆå‘˜æˆ–é‚€è¯·å°šæœªæ¿€æ´»');
  setIsSharing(false);
  return;
}
```

## ğŸ¯ æµ‹è¯•å»ºè®®

1. **æµ‹è¯•é‚€è¯·æµç¨‹**ï¼š
   - ç”¨æˆ· A é‚€è¯·ç”¨æˆ· Bï¼ˆé‚®ç®±ï¼šb@example.comï¼‰
   - ç”¨æˆ· B æ³¨å†Œ/ç™»å½•
   - æ£€æŸ¥ç”¨æˆ· B æ˜¯å¦è‡ªåŠ¨æ¿€æ´»

2. **æµ‹è¯•æƒé™æ§åˆ¶**ï¼š
   - æœªæ¿€æ´»çš„ç”¨æˆ·å°è¯•åˆ›å»ºæ–‡ä»¶å¤¹ï¼ˆåº”è¯¥å¤±è´¥ï¼‰
   - æœªæ¿€æ´»çš„ç”¨æˆ·å°è¯•åˆ†äº«è§†é¢‘ï¼ˆåº”è¯¥å¤±è´¥ï¼‰
   - æ¿€æ´»çš„ç”¨æˆ·å¯ä»¥æ­£å¸¸æ“ä½œ

3. **æµ‹è¯•ä¸åŒè§’è‰²**ï¼š
   - Viewer è§’è‰²å¯ä»¥åˆ›å»ºæ–‡ä»¶å¤¹å’Œåˆ†äº«è§†é¢‘
   - Editor è§’è‰²å¯ä»¥åˆ›å»ºæ–‡ä»¶å¤¹å’Œåˆ†äº«è§†é¢‘
   - Admin è§’è‰²å¯ä»¥åˆ›å»ºæ–‡ä»¶å¤¹ã€åˆ†äº«è§†é¢‘ã€é‚€è¯·æˆå‘˜
   - Owner è§’è‰²æ‹¥æœ‰æ‰€æœ‰æƒé™
