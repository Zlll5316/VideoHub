# 💰 Google Gemini API 配额说明

## 关于 API 配额

是的，**Google Gemini API 确实有配额限制**，这可能是你遇到连接问题的原因之一。

### 免费配额限制

Google Gemini API 的免费版有以下限制：

1. **每分钟请求数（RPM）**：通常为 15-60 次/分钟
2. **每天请求数（RPD）**：通常为 1500 次/天
3. **每月配额**：根据账户类型不同

### 常见错误

#### 1. 429 错误（配额已用完）
```
429 ResourceExhausted: Quota exceeded
```
**原因**：免费配额已用完

**解决方案**：
- 等待配额重置（通常24小时重置一次）
- 访问 https://aistudio.google.com/app/apikey 查看配额使用情况
- 考虑升级到付费计划

#### 2. 403 错误（权限不足）
```
403 Permission denied
```
**原因**：API Key 无效或服务未启用

**解决方案**：
- 检查 API Key 是否正确
- 访问 https://aistudio.google.com/app/apikey 重新生成
- 确保已启用 Gemini API 服务

#### 3. 401 错误（认证失败）
```
401 Unauthorized
```
**原因**：API Key 无效或已过期

**解决方案**：
- 检查 `main.py` 中的 `API_KEY` 是否正确
- 重新生成 API Key

## 🔍 如何检查配额

1. 访问：https://aistudio.google.com/app/apikey
2. 登录你的 Google 账号
3. 查看 API 使用情况和配额限制

## 💡 解决方案

### 方案1：等待配额重置（免费）
- 免费配额通常每24小时重置一次
- 可以等待一段时间后重试

### 方案2：升级到付费计划
- 访问 Google Cloud Console
- 设置付费账户（需要绑定信用卡）
- 获得更高的配额限制

### 方案3：使用备用 API（如果实现）
- 可以配置 OpenAI API 作为备用
- 新用户有 $5 免费额度

## 📊 当前代码的改进

我已经改进了错误处理，现在会：

1. **自动识别错误类型**：
   - 429（配额用完）
   - 403（权限不足）
   - 401（认证失败）
   - 404（模型不存在）

2. **提供详细解决方案**：
   - 针对不同错误类型给出具体建议
   - 包含相关链接和操作步骤

3. **友好的错误提示**：
   - 前端会显示清晰的错误信息
   - 包含解决步骤

## ⚠️ 重要提示

**重启后端后**，新的错误处理才会生效。如果遇到错误，现在会看到更清晰的提示信息，帮助你快速定位问题。
